var app=angular.module("angular-mini-preview",[]),prefix="ng-mini-preview",AngularMiniPreview=function(a,b){this.element=a,this.attrs=b,this.element.addClass(prefix+"-anchor"),this.generate()};AngularMiniPreview.prototype={options:{width:300,height:200,scale:.25,load:"preload"},generate:function(){this.generateElements(),this.load()},generateElements:function(){var a=angular.element("<div>").addClass(prefix+"-wrapper");if("auto"==this.attrs.miniDirection){var b,c,d=this.element[0].getBoundingClientRect(),e=d.top;window.innerWidth?b=window.innerWidth:document.body&&document.body.clientWidth&&(b=document.body.clientWidth),window.innerHeight?c=window.innerHeight:document.body&&document.body.clientHeight&&(c=document.body.clientHeight);var f=c-d.bottom,g=d.left,h=b-d.right;this.attrs.miniDirection=e>f?g>h?"tl":"tr":g>h?"bl":"br"}a.css("tr"==this.attrs.miniDirection?{width:this.attrs.miniWidth||this.options.width+"px",height:this.attrs.miniHeight||this.options.height+"px",bottom:(this.element[0].height||this.element[0].offsetHeight)/2+"px",left:(this.element[0].width||this.element[0].offsetWidth)/2+"px"}:"tl"==this.attrs.miniDirection?{width:this.attrs.miniWidth||this.options.width+"px",height:this.attrs.miniHeight||this.options.height+"px",bottom:(this.element[0].height||this.element[0].offsetHeight)/2+"px",right:(this.element[0].width||this.element[0].offsetWidth)/2+"px"}:"bl"==this.attrs.miniDirection?{width:this.attrs.miniWidth||this.options.width+"px",height:this.attrs.miniHeight||this.options.height+"px",top:(this.element[0].height||this.element[0].offsetHeight)/2+"px",right:(this.element[0].width||this.element[0].offsetWidth)/2+"px"}:{width:this.attrs.miniWidth||this.options.width+"px",height:this.attrs.miniHeight||this.options.height+"px",top:(this.element[0].height||this.element[0].offsetHeight)/2+"px",left:(this.element[0].width||this.element[0].offsetWidth)/2+"px"});var i=angular.element("<div>").addClass(prefix+"-loading"),j=angular.element("<iframe>").addClass(prefix+"-frame").css({width:100/this.options.scale+"%",height:100/this.options.scale+"%",transform:"scale("+this.options.scale+")","-ms-transform":"scale("+this.options.scale+")","-moz-transform":"scale("+this.options.scale+")","-webkit-transform":"scale("+this.options.scale+")","-o-transform":"scale("+this.options.scale+")"});a.append(i),a.append(j),this.element.append(a)},load:function(){var a=this;this.attrs.lazyLoad?this.element.bind("mouseover",function(){a.preview()}):this.preview()},preview:function(){var a=this.element.find("iframe");this.attrs.lazyLoad&&this.element.bind("mouseout",function(){a.attr("src","")}),a&&a.attr("src",this.attrs.miniPreview||this.attrs.href)}},app.directive("miniPreview",function(){return{restrict:"A",link:function(a,b,c){new AngularMiniPreview(b,c)}}});